<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<title></title>
	<link href="css/mui.min.css" rel="stylesheet"/>
</head>
<body>

	<div class="mui-off-canvas-wrap mui-draggable">
		<div class="mui-inner-wrap">
			<header class="mui-bar mui-bar-nav">
				<!--<a class="mui-icon mui-icon-left-nav mui-pull-left mui-action-back"></a>-->
				<button class="mui-btn mui-btn-link mui-btn-nav mui-pull-right" id="add">
					新增
					<span class="mui-icon mui-icon-right-nav"></span>
				</button>
				<h1 class="mui-title">所有联系人</h1>
			</header>
			<aside id="offCanvas" class="mui-off-canvas-left">
				<ul class="mui-table-view mui-table-view-chevron mui-table-view-inverted">
					<li class="mui-table-view-cell">
						<a class="mui-navigate-right">
						Item 1
					</a>
					</li>
					<li class="mui-table-view-cell">
						<a class="mui-navigate-right">
						Item 2
					</a>
					</li>
					<li class="mui-table-view-cell">
						<a class="mui-navigate-right">
						Item 3
					</a>
					</li>
				</ul>
			</aside>
			<div class="mui-content">
				<ul class="mui-table-view mui-table-view-chevron" id="contactList">
					<!--<li class="mui-table-view-cell">
						<div class="mui-slider-right mui-disabled">
							<a class="mui-btn mui-btn-grey mui-icon mui-icon-person"></a>
							<a class="mui-btn mui-btn-yellow mui-icon mui-icon-phone"></a>
							<a class="mui-btn mui-btn-red mui-icon mui-icon-email"></a>
						</div>
						<div class="mui-slider-handle">
							<div class="mui-table-cell">
								桂永顺
							</div>
						</div>
					</li>-->
				</ul>
			</div>
			<!-- off-canvas backdrop -->
			<div class="mui-off-canvas-backdrop"></div>
		</div>
	</div>
	<script id="tpl" type="text/html">
	    <%for(var i = 0,len = list.length; i < len; i++) {%>
	    	<li class="mui-table-view-cell">
	    		<div class="mui-slider-right mui-disabled">
	    			<a class="mui-btn mui-btn-grey mui-icon mui-icon-person"></a>
	    			<a class="mui-btn mui-btn-yellow mui-icon mui-icon-phone"></a>
	    			<a class="mui-btn mui-btn-red mui-icon mui-icon-email"></a>
	    		</div>
	    		<div class="mui-slider-handle">
	    			<div class="mui-table-cell"><%:=list[i].name %></div>
	    		</div>
	    	</li>
	    <%}%>
	</script>
	<script src="js/mui.min.js"></script>
	<script src="js/template.js"></script>
	<script src = "https://cdn.wilddog.com/js/client/current/wilddog.js" ></script>
	<script type="text/javascript" charset="utf-8">
		(function($) {
			$.init();
			var ref = new Wilddog("https://contact.wilddogio.com/contacts");
			
			ref.on("value", function(datasnapshot) {
				var val = datasnapshot.val();
				var list = [];
				for(var item in val){
					console.log(val[item].id);
					list.push({'name': val[item].name,'id': val[item].id});
				};
				var tpl = document.getElementById('tpl').innerHTML;
				var tmp = template(tpl, {'list': list});
				document.getElementById('contactList').innerHTML = tmp;
			});
			
			
			$.plusReady(function() {
				var page = mui.preload({
					url: 'info.html',
					id: 'info'					
				});
				document.getElementById('contactList').addEventListener('tap', function(e) {
					e = e || window.event;
					var target = e.target || srcElement;
					if (target.nodeName.toLowerCase() == 'li' || target.nodeName.toLowerCase() == 'div') {
						$.openWindow('info');
					};
				});
				document.getElementById('add').addEventListener('tap', function(e) {
					e = e || window.event;
					var target = e.target || srcElement;
					$.openWindow({
						url: 'add.html',
						id: 'add'
					})
				});
			});
		})(mui);
	</script>
</body>
</html>